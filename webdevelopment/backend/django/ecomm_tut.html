<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">

<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Ecommerce Tutorial - Knowledge Base</title>
    
    


    <!-- Custom HTML head -->
    


    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    
    
    <link rel="shortcut icon" href="../../../favicon.png">
    
    <link rel="stylesheet" href="../../../css/variables.css">
    <link rel="stylesheet" href="../../../css/general.css">
    <link rel="stylesheet" href="../../../css/chrome.css">
    
    <link rel="stylesheet" href="../../../css/print.css" media="print">
    

    <!-- Fonts -->
    <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
    
    <link rel="stylesheet" href="../../../fonts/fonts.css">
    

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../../highlight.css">
    <link rel="stylesheet" href="../../../tomorrow-night.css">
    <link rel="stylesheet" href="../../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
    

    
</head>

<body>
    <!-- Provide site root to javascript -->
    <script type="text/javascript">
        var path_to_root = "../../../";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
    </script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');

            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }

            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch (e) { }
        if (theme === null || theme === undefined) { theme = default_theme; }
        var html = document.querySelector('html');
        html.classList.remove('no-js')
        html.classList.remove('light')
        html.classList.add(theme);
        html.classList.add('js');
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch (e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox">
            <ol class="chapter"><li class="chapter-item affix "><a href="../../../index.html">Intro</a></li><li class="chapter-item affix "><a href="../../../acknowledgments.html">Acknowledgments</a></li><li class="chapter-item expanded "><a href="../../../webdevelopment/webdevelopment.html"><strong aria-hidden="true">1.</strong> Web Development</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/frontend/frontend.html"><strong aria-hidden="true">1.1.</strong> Front-end</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/frontend/css.html"><strong aria-hidden="true">1.1.1.</strong> CSS</a></li><li class="chapter-item "><a href="../../../webdevelopment/frontend/design.html"><strong aria-hidden="true">1.1.2.</strong> Design</a></li><li class="chapter-item "><a href="../../../webdevelopment/frontend/html.html"><strong aria-hidden="true">1.1.3.</strong> HTML</a></li><li class="chapter-item "><a href="../../../webdevelopment/frontend/js.html"><strong aria-hidden="true">1.1.4.</strong> Javascript</a></li><li class="chapter-item "><a href="../../../webdevelopment/frontend/Vue/vue.html"><strong aria-hidden="true">1.1.5.</strong> VueJs</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/frontend/Vue/axios.html"><strong aria-hidden="true">1.1.5.1.</strong> Axios</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/frontend/nuxt.html"><strong aria-hidden="true">1.1.6.</strong> Nuxt</a></li></ol></li><li class="chapter-item expanded "><a href="../../../webdevelopment/backend/backend.html"><strong aria-hidden="true">1.2.</strong> Back-end</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/backend/database/database.html"><strong aria-hidden="true">1.2.1.</strong> Database</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/backend/database/sql.html"><strong aria-hidden="true">1.2.1.1.</strong> SQL</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/database/nosql.html"><strong aria-hidden="true">1.2.1.2.</strong> NoSQL</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/backend/hosting/hosting.html"><strong aria-hidden="true">1.2.2.</strong> Hosting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/backend/hosting/vps.html"><strong aria-hidden="true">1.2.2.1.</strong> VPS</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/backend/server/server.html"><strong aria-hidden="true">1.2.3.</strong> Servers</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/backend/server/apache.html"><strong aria-hidden="true">1.2.3.1.</strong> Apache</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/server/nginx.html"><strong aria-hidden="true">1.2.3.2.</strong> NGINX</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/server/gunicorn.html"><strong aria-hidden="true">1.2.3.3.</strong> GUnicorn</a></li></ol></li><li class="chapter-item expanded "><a href="../../../webdevelopment/backend/django/django.html"><strong aria-hidden="true">1.2.4.</strong> Django</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/backend/django/model.html"><strong aria-hidden="true">1.2.4.1.</strong> Models</a></li><li class="chapter-item expanded "><a href="../../../webdevelopment/backend/django/ecomm_tut.html" class="active"><strong aria-hidden="true">1.2.4.2.</strong> Ecommerce Tutorial</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/django/fixtures.html"><strong aria-hidden="true">1.2.4.3.</strong> Fixtures</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/django/heroku.html"><strong aria-hidden="true">1.2.4.4.</strong> heroku</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/django/view.html"><strong aria-hidden="true">1.2.4.5.</strong> Views</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/django/restframework.html"><strong aria-hidden="true">1.2.4.6.</strong> Rest Framework</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/django/projectstartchecklist.html"><strong aria-hidden="true">1.2.4.7.</strong> Setup</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/backend/.md.html"><strong aria-hidden="true">1.2.5.</strong> DOM</a></li><li class="chapter-item "><a href="../../../webdevelopment/backend/sustainability.html"><strong aria-hidden="true">1.2.6.</strong> Sustainability / Scalability</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/projects/projects.html"><strong aria-hidden="true">1.3.</strong> Projects</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/projects/raspberrypi.html"><strong aria-hidden="true">1.3.1.</strong> Raspberry Pi</a></li><li class="chapter-item "><a href="../../../webdevelopment/projects/tralelho.html"><strong aria-hidden="true">1.3.2.</strong> Tralelho</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/web/web.html"><strong aria-hidden="true">1.4.</strong> Web Technologies</a></li><li class="chapter-item "><a href="../../../webdevelopment/security/security.html"><strong aria-hidden="true">1.5.</strong> Security</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../webdevelopment/security/vulnerabilities.html"><strong aria-hidden="true">1.5.1.</strong> Vulnerabilities</a></li></ol></li><li class="chapter-item "><a href="../../../webdevelopment/testing/testing.html"><strong aria-hidden="true">1.6.</strong> Testing</a></li></ol></li><li class="chapter-item "><a href="../../../system/system.html"><strong aria-hidden="true">2.</strong> System Knowledge</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../system/hardware/hardware.html"><strong aria-hidden="true">2.1.</strong> Hardware</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../system/hardware/history.html"><strong aria-hidden="true">2.1.1.</strong> History</a></li></ol></li><li class="chapter-item "><a href="../../../system/software/software.html"><strong aria-hidden="true">2.2.</strong> Software</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../system/software/collaboration/collaboration.html"><strong aria-hidden="true">2.2.1.</strong> Collaboration</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../system/software/collaboration/discord.html"><strong aria-hidden="true">2.2.1.1.</strong> Discord</a></li><li class="chapter-item "><a href="../../../system/software/collaboration/slack.html"><strong aria-hidden="true">2.2.1.2.</strong> Slack</a></li><li class="chapter-item "><a href="../../../system/software/collaboration/teamviewer.html"><strong aria-hidden="true">2.2.1.3.</strong> Teamviewer</a></li></ol></li><li class="chapter-item "><a href="../../../system/software/os/os.html"><strong aria-hidden="true">2.2.2.</strong> OS</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../system/software/os/linux.html"><strong aria-hidden="true">2.2.2.1.</strong> Linux</a></li><li class="chapter-item "><a href="../../../system/software/os/windows.html"><strong aria-hidden="true">2.2.2.2.</strong> Windows</a></li><li class="chapter-item "><a href="../../../system/software/os/kernel.html"><strong aria-hidden="true">2.2.2.3.</strong> Kernels</a></li></ol></li><li class="chapter-item "><a href="../../../system/software/bios.html"><strong aria-hidden="true">2.2.3.</strong> Bios</a></li><li class="chapter-item "><a href="../../../system/software/uefi.html"><strong aria-hidden="true">2.2.4.</strong> UEFI</a></li><li class="chapter-item "><a href="../../../system/software/commandline.html"><strong aria-hidden="true">2.2.5.</strong> Commandline</a></li><li class="chapter-item "><a href="../../../system/software/elasticsearch.html"><strong aria-hidden="true">2.2.6.</strong> Elasticsearch</a></li><li class="chapter-item "><a href="../../../system/software/git.html"><strong aria-hidden="true">2.2.7.</strong> Git</a></li><li class="chapter-item "><a href="../../../system/software/github.html"><strong aria-hidden="true">2.2.8.</strong> Github</a></li><li class="chapter-item "><a href="../../../system/software/linters.html"><strong aria-hidden="true">2.2.9.</strong> Linters</a></li><li class="chapter-item "><a href="../../../system/software/packagemanagers.html"><strong aria-hidden="true">2.2.10.</strong> Packagemanagers</a></li><li class="chapter-item "><a href="../../../system/software/vscode.html"><strong aria-hidden="true">2.2.11.</strong> VSCode</a></li></ol></li></ol></li><li class="chapter-item "><a href="../../../organisational/orga.html"><strong aria-hidden="true">3.</strong> Organisational</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../organisational/business/business.html"><strong aria-hidden="true">3.1.</strong> Business</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../organisational/business/autoentrepreneur.html"><strong aria-hidden="true">3.1.1.</strong> Auto-Entrpreneur</a></li></ol></li><li class="chapter-item "><a href="../../../organisational/legal/legal.html"><strong aria-hidden="true">3.2.</strong> Legal</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../../organisational/legal/licenses.html"><strong aria-hidden="true">3.2.1.</strong> Licenses</a></li></ol></li></ol></li></ol>
        </div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
            
            <div id="menu-bar-hover-placeholder"></div>
            <div id="menu-bar" class="menu-bar sticky bordered">
                <div class="left-buttons">
                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents"
                        aria-label="Toggle Table of Contents" aria-controls="sidebar">
                        <i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme"
                        aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme"
                                id="light">Light (default)</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme"
                                id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button>
                        </li>
                    </ul>
                    
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)"
                        aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S"
                        aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                    
                </div>

                <h1 class="menu-title">Knowledge Base</h1>

                <div class="right-buttons">
                    
                    <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    
                    
                    <a href="https://github.com/3ng7n33r/KnowledgeBase" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
                    
                </div>
            </div>

            
            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" name="search" id="searchbar" name="searchbar"
                        placeholder="Search this book ..." aria-controls="searchresults-outer"
                        aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>
            

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                Array.from(document.querySelectorAll('#sidebar a')).forEach(function (link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                });
            </script>

            <div id="content" class="content">
                <main>
                    <h1 id="ecomm-tut"><a class="header" href="#ecomm-tut">Ecomm tut</a></h1>
<p><a href="https://www.youtube.com/watch?v=Yg5zkd9nm6w&amp;list=WL&amp;index=70">Link</a></p>
<h2 id="setup-and-install-django"><a class="header" href="#setup-and-install-django">Setup and install Django</a></h2>
<pre><code>create repo
clone repo
create virtualenv: virtualenv env
source env/bin/activate
pip install django
pip install django-rest-framework
pip install django-cors-headers
pip install djoser
pip install pillow &lt; -- image library
pip install stripe
django-admin startproject djackets_django
</code></pre>
<p>add to setting.py -&gt; installed apps:</p>
<pre><code>'rest_framework',
'rest_framework.authtoken',
'corsheaders',
'djoser',
</code></pre>
<p>configure cors (add to settings.py):</p>
<pre><code>CORS_ALLOWED_ORIGINS = [
	&quot;http://localhost:8080&quot;,
]
</code></pre>
<p>configure middleware:</p>
<pre><code>'corsheaders.middleware.CorsMiddleware',
#has to be above commonmiddleware
</code></pre>
<p>configure urls:</p>
<pre><code>from django.urls import include
urlpatterns = [
...
path('api/v1/', include('djoser.urls')),
path('api/v1/', include('djoser.urls.authtoken')),
</code></pre>
<p>makemigrations - migrate - creatsuperuser - Done!</p>
<h2 id="install-and-setup-vue"><a class="header" href="#install-and-setup-vue">Install and setup vue</a></h2>
<p>install vue on the pc if necessary:</p>
<pre><code>npm install -g @vue/cli
</code></pre>
<p>start project:</p>
<pre><code>vue create djackets_vue
</code></pre>
<p>Install packages:</p>
<pre><code>cd djackets_vue
npm install axios &lt;- make API calls
npm install bulma &lt;- CSS framework
</code></pre>
<p>add FontAwesome to public/index.html:</p>
<pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css&quot;&gt;
</code></pre>
<p>replace style in app.vue with:</p>
<pre><code>@import  '../node_modules/bulma';
and replace navbar according to vid @18:30
</code></pre>
<h2 id="create-django-app"><a class="header" href="#create-django-app">Create Django app</a></h2>
<p>python manage.py startapp product</p>
<p>create models ...</p>
<h3 id="creating-thumbnails-of-images"><a class="header" href="#creating-thumbnails-of-images">Creating thumbnails of images:</a></h3>
<p>To create thumbnails of images, you need to import the Pillow library, BytesIO and the File wrapper:</p>
<pre><code>from django.core.files import File
from io import BytesIO
from PIL import Image
</code></pre>
<p>and add this function to the corresponding model:</p>
<pre><code>def make_thumbnail(self, image, size=(300, 200)):
    img = Image.open(image)
    img.convert('RGB')
    img.thumbnail(size)
    thumb_io = BytesIO()
    img.save(thumb_io, 'JPEG', quality=85)
    thumbnail = File(thumb_io, name=image.name)
    return thumbnail
</code></pre>
<p>and add media to settings.py:</p>
<pre><code>MEDIA_URL = '/media/'
MEDIA_ROOT = BASE_DIR / 'media'
</code></pre>
<p>and to urls.py:</p>
<pre><code>from django.conf import settings
from django.conf.urls.static import static
...

urlpatterns = [
...
] + static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
</code></pre>
<h3 id="creating-the-api-view"><a class="header" href="#creating-the-api-view">creating the API view</a></h3>
<pre><code>from rest_framework.views import APIView
from rest_framework.response import Response

from .models import Product
from .serializers import ProductSerializer

class LatestProductsList(APIView):
    def get(self, request, format=None):
        products = Product.objects.all()[:4]
        serializer = ProductSerializer(products, many=True)
        return Response(serializer.data)
</code></pre>
<p>and add that view to products/urls.py (keep links for apps seperated):</p>
<pre><code>from django.urls import path, include
from product import views

urlpatterns = [
    path('latest-products/' ,views.LatestProductsList.as_view())    
]
</code></pre>
<p>and don't forget to add a link to the apps urls into the projects urls.py:</p>
<pre><code>urlpatterns = [
	...
    path('api/v1/', include('product.urls')),
] ...
</code></pre>
<h2 id="create-vue-frontpage"><a class="header" href="#create-vue-frontpage">Create Vue frontpage</a></h2>
<p>Create the page and import the data with axios. For that:</p>
<ol>
<li>Create an empty data array</li>
<li>create a method with an axios get request to consume the api</li>
<li>create a mounted lifecycle hook to import the data</li>
</ol>
<pre><code class="language-js">&lt;script&gt;
import axios from 'axios' //&lt;- import the module
export default {
  name: 'Home',
  data() {
    return {
      latestProducts: [] //empty Array
    }
  },
  components: {
  }
  mounted() { //&lt;-- Lifecycle hook calling the method when DOM is mounted
    this.getLatestProducts()
  },
  methods: {
    getLatestProducts() { //&lt;- the axios get request
      axios
        .get('/api/v1/latest-products')
        .then(response =&gt; {
          this.latestProducts = response.data
        })
        .catch(error =&gt; {
          console.log(error)
        })
    }
  }
}
&lt;/script&gt;
</code></pre>
<p>It won't work yet because the URL is unknown and axios needs to be imported into main.js:</p>
<pre><code>import axios from 'axios'

axios.defaults.baseURL = 'http://127.0.0.1:8000'

createApp(App).use(store).use(router, axios).mount('#app')
</code></pre>
<h3 id="product-detail-page"><a class="header" href="#product-detail-page">Product detail page</a></h3>
<p><strong>Backend</strong>
First, create the API endpoint for the product detail on the backend. views.py:</p>
<pre><code class="language-python">class ProductDetail(APIView):
    def get_object(self, category_slug, product_slug):
        try:
            return Product.objects.filter(category__slug=category_slug).get(slug=product_slug)
        except Product.DoesNotExist:
            raise Http404
    
    def get(self, category_slug, product_slug, format=None):
        product = self.get_object(category_slug, product_slug)
        serializer = ProductSerializer(product)

        return Response(serializer.data)
</code></pre>
<p><strong>Frontend</strong>
add product.vue to vews folder. Check template <a href="https://github.com/SteinOveHelset/djackets_vue/blob/master/src/views/Product.vue">here</a> 
and add the products page to the view router -&gt; index.js:</p>
<pre><code class="language-js">import  Product  from  '../views/Product.vue'
const routes = [
...
 {
   path: '/:category_slug/:product_slug',
   name: 'Product',
   component: Product
 }
]
</code></pre>
<h3 id="slugs"><a class="header" href="#slugs">Slugs</a></h3>
<p>The way the links in the URL work is like this:
They start in the backend with the models get_absolute_url method.
This function creates a string out of the category and the name and transforms it into slugs and into a link. 
The link i ś then shown on the front page which loops through every unique object. If the link is clicked, the slug gets taken in from the router and is then passed on as an argument in the detail view. The detail view calls the detail backend API using the slugs to identify the item to the backend. The backend delivers further details to the product view with an axios call.</p>
<ol>
<li>Backend function get_absolute_url in model to create a url to the db entry made out of slugs</li>
<li>Give a list of all objects to the main page in Vue, loop through this list and create a card with a link containing the frontend url out of the slugs of each object</li>
<li>If a link is clicked, the product page is displayed. Here, the vue router gives the slugs from the url to the vue-view. The view method calls the backend api using the same slugs to create the link.</li>
<li>The backend API gives the details of that single object to the vue-view which uses it to create the product detail page.</li>
</ol>
<h2 id="state-management-with-vue-x"><a class="header" href="#state-management-with-vue-x">State management with vue x</a></h2>
<p><a href="https://vuex.vuejs.org/#what-is-a-state-management-pattern">VueX</a>
Create the store functionality in store/index.js:</p>
<pre><code class="language-js">import { createStore } from 'vuex'

export default createStore({
  state: {
    cart: {
      items: [],
    },
    isAuthenticated: false,
    token: '',
    isLoading: false
  },
  mutations: {
    initializeStore(state) {
      if (localStorage.getItem('cart')) {
        state.cart = JSON.parse(localStorage.getItem('cart'))
      } else {
        localStorage.setItem('cart', JSON.stringify(state.cart))
      }
    },
    addToCart(state, item) {
      const exists = state.cart.items.filter(i =&gt; i.product.id === item.product.id)

      if (exists.length) {
        exists[0].quantity = parseInt(exists[0].quantity) + parseInt(item.quantity)
      } else {
        state.cart.items.push(item)
      }

      localStorage.setItem('cart', JSON.stringify(state.cart))
    }
  },
  actions: {
  },
  modules: {
  }
})
</code></pre>
<p>and add the store to the App.vue:</p>
<pre><code class="language-js">&lt;script&gt;
  export default{
    data (){
      return {
	...
        cart: {
          items: [],
        }
      }
    },
    beforeCreate() {
      this.$store.commit('initializeStore') //commit calls mutations defined in the store file
    }
    
  }
&lt;/script&gt;
</code></pre>
<p>to make it possible to add an item to the cart, this needs to be implemented in the Product page. First, a button is added with the functionality:</p>
<pre><code class="language-js">...
	&lt;div class=&quot;control&quot;&gt;
	    &lt;a class=&quot;button is-dark&quot; @click=&quot;addToCart()&quot;&gt;Add to cart&lt;/a&gt;
	&lt;/div&gt;
...


&lt;script&gt;
...
export default {
    name: 'Product',
    data() {
        return {
            product: {},
            quantity: 1
        }
    },
...
    methods: {
...
        addToCart() {
            if (isNaN(this.quantity) || this.quantity &lt; 1) {
                this.quantity = 1
            }
            const item = {
                product: this.product,
                quantity: this.quantity
            }
            this.$store.commit('addToCart', item)
        }
    }
}
&lt;/script&gt;
</code></pre>
<p>and make sure the cart is initialised as variable in app.vue:</p>
<pre><code class="language-js">&lt;script&gt;
...
    mounted() {
      this.cart = this.$store.state.cart
    },
    computed: {
      cartTotalLength() {
        let totalLength = 0

        for (let i = 0; i &lt; this.cart.items.length; i++) {
          totalLength += this.cart.items[i].quantity
        }

        return totalLength 
      }
    }
    
  }
&lt;/script&gt;
</code></pre>
<p>To give the add to cart button some responsibility, we will use a &quot;toast&quot; popup that shows that an item has been added. Bulma has such an extension that can be installed with:</p>
<pre><code>$ npm install bulma-toast
</code></pre>
<p>and add the toast functionality to the product view:</p>
<pre><code class="language-js">&lt;script&gt;
...
import { toast } from 'bulma-toast'
export default {
	...
    methods: {
		...
            toast({
                message: 'The product was added to the cart',
                type: 'is-success',
                dismissible: true,
                pauseOnHover: true,
                duration: 2000,
                position: 'bottom-right',
            })
...
&lt;/script&gt;
</code></pre>
<h3 id="add-a-loading-bar-while-fe-communicates-with-be-server"><a class="header" href="#add-a-loading-bar-while-fe-communicates-with-be-server">add a loading bar while FE communicates with BE server</a></h3>
<p>in the store/index.js add a state isLoading and the functionailty to use it:</p>
<pre><code class="language-js">import { createStore } from 'vuex'

export default createStore({
  state: {
	...
    isLoading: false
  },
  mutations: {
	...
    setIsLoading(state, status) {
      state.isLoading = status
    }
</code></pre>
<p>and set that status to true as soon as soon as the product page requests the details from the server (views/products.vue). To make sure that loading false is not called before the axios call is actually finished, make sure to set the function to <strong>async</strong> and add <strong>await</strong> to the axios call:</p>
<pre><code class="language-js">&lt;script&gt;
...
export default {
...
    methods: {
        async getProduct() {
            this.$store.commit('setIsLoading', true)
		...await axios call
            this.$store.commit('setIsLoading', false)
        },
</code></pre>
<p>and add the loading symbol to the app.vue:</p>
<pre><code class="language-js">    &lt;div class=&quot;is-loading-bar has-text-centered&quot; :class=&quot;{'is-loading': $store.state.isLoading}&quot;&gt;
      &lt;div class=&quot;lds-dual-ring&quot;&gt;&lt;/div&gt;
    &lt;/div&gt;
</code></pre>
<h3 id="create-a-category-view"><a class="header" href="#create-a-category-view">Create a category view</a></h3>
<p>To create the category view we go the same way as for the detail view:</p>
<ul>
<li>Create view file Category.vue</li>
<li>Within, create the template, the axios call etc.</li>
<li>Create the entry in the router/index.js</li>
</ul>
<p>Important: 
If we now change from Winter to Summer, the page will  not change as they have a similar url ('category-slug') so the mounted lifecycle hook will not be called. To make navigation between similiarly named, dynamically created routes possible there is an option called &quot;watch&quot;. This has to be added to the &quot;Category.vue&quot;:</p>
<pre><code class="language-js">&lt;script&gt;
...
export default {
	...
    watch: {
        $route(to, from) {
            if (to.name === 'Category') {
                this.getCategory()
            }
        }
    },
</code></pre>
<h2 id="add-search-function"><a class="header" href="#add-search-function">Add search function</a></h2>
<h3 id="backend"><a class="header" href="#backend">Backend</a></h3>
<p>First, we add an Endpoint in our backend for the search functionality. In our views.py we add:</p>
<pre><code class="language-py">from django.db.models import Q #Improves query functionality (&amp; and , | or )
from rest_framework.decorators import api_view #the decorator to only use this function with a POST request
....
@api_view(['POST'])
def search(request):
    query = request.data.get('query', '')

    if query:
        products = Products.objects.filter(Q(name__icontains=query) | Q(description__icontains=query))
        serializer = ProductSerializer(products, many=True)
        return Response(serializer.data)
    else:
        return Response({'products': []})
</code></pre>
<p>and add the entry to the urls.py file:</p>
<pre><code class="language-py">urlpatterns = [
...
    path('products/search', views.search),
    ...
]
</code></pre>
<h3 id="frontend"><a class="header" href="#frontend">Frontend</a></h3>
<p>add a searchbar to the navbar in App.vue:</p>
<pre><code class="language-js">&lt;form method=&quot;get&quot; action=&quot;/search&quot;&gt;
  &lt;div class=&quot;field has-addons&quot;&gt;
    &lt;div class=&quot;control&quot;&gt;
      &lt;input type=&quot;text&quot; class=&quot;input&quot; placeholder=&quot;What are you looking for?&quot; name=&quot;query&quot;&gt;
    &lt;/div&gt;
    &lt;div class=&quot;control&quot;&gt;
      &lt;button class=&quot;button is-success&quot;&gt;
        &lt;span class=&quot;icon&quot;&gt;
          &lt;i class=&quot;fas fa-search&quot;&gt;&lt;/i&gt;
        &lt;/span&gt;
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/form&gt;
</code></pre>
<p>and create a landing page for that site that displays the results:</p>
<pre><code class="language-js">&lt;template&gt;
... 
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import ProductBox from '@/components/ProductBox.vue'

    export default {
        name: 'Search',
        components: {
            ProductBox
        },
        data() {
            return {
                products: [],
                query: '',
            }
        },
        mounted() {
            document.title = 'Search | Djackets '

            let uri = window.location.search.substring(1) // I don't get it, to look into
            let params = new URLSearchParams(uri) //don't get it neither

            if (params.get('query')) {
                this.query = params.get('query')

                this.performSearch()
            }
        },
        methods: {
            async performSearch () {
                this.$store.commit('setIsLoading', true)

                await axios
                    .post('/api/v1/products/search/', {'query': this.query})
                    .then(response =&gt; {
                        this.products = response.data
                    })
                    .catch(error =&gt; {
                        console.log(error)
                    })
                
                this.$store.commit('setIsLoading', false)
            }
        }
    }
&lt;/script&gt;
</code></pre>
<p>add that page to the router:</p>
<pre><code class="language-js">import Search from '../views/Search.vue'

const routes = [
	...
  {
    path: '/search',
    name: 'Search',
    component: Search
  },
]
</code></pre>
<p>Done!</p>
<h2 id="add-a-cart"><a class="header" href="#add-a-cart">Add a cart</a></h2>
<p>Kind of the same thing by now. Add a view and a router entry. In this instance, we want to display each item in a particular way so it makes sense to create a component for this too. The most important parts are the functionality sections of the site and the component. Cart.vue:</p>
<pre><code class="language-js">&lt;template&gt;
    &lt;div class=&quot;page-cart&quot;&gt;
        &lt;div class=&quot;columns is-multiline&quot;&gt;
            &lt;div class=&quot;column is-12&quot;&gt;
                &lt;h1 class=&quot;title&quot;&gt;Cart&lt;/h1&gt;
            &lt;/div&gt;

            &lt;div class=&quot;column is-12 box&quot;&gt;
                &lt;table class=&quot;table is-fullwidth&quot; v-if=&quot;cartTotalLength&quot;&gt;
                    &lt;thead&gt;
                        &lt;tr&gt;
                            &lt;th&gt;Product&lt;/th&gt;
                            &lt;th&gt;Price&lt;/th&gt;
                            &lt;th&gt;Quantity&lt;/th&gt;
                            &lt;th&gt;Total&lt;/th&gt;
                            &lt;th&gt;&lt;/th&gt;
                        &lt;/tr&gt;
                    &lt;/thead&gt;

                    &lt;tbody&gt;
                        &lt;CartItem
                            v-for=&quot;item in cart.items&quot;
                            v-bind:key=&quot;item.product.id&quot;
                            v-bind:initialItem=&quot;item&quot;
                            v-on:removeFromCart=&quot;removeFromCart&quot; /&gt;
                    &lt;/tbody&gt;
                &lt;/table&gt;

                &lt;p v-else&gt;You don't have any products in your cart...&lt;/p&gt;
            &lt;/div&gt;

            &lt;div class=&quot;column is-12 box&quot;&gt;
                &lt;h2 class=&quot;subtitle&quot;&gt;Summary&lt;/h2&gt;

                &lt;strong&gt;${{ cartTotalPrice.toFixed(2) }}&lt;/strong&gt;, {{ cartTotalLength }} items

                &lt;hr&gt;

                &lt;router-link to=&quot;/cart/checkout&quot; class=&quot;button is-dark&quot;&gt;Proceed to checkout&lt;/router-link&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import CartItem from '@/components/CartItem.vue'
export default {
    name: 'Cart',
    components: {
        CartItem
    },
    data() {
        return {
            cart: {
                items: []
            }
        }
    },
    mounted() {
        this.cart = this.$store.state.cart
    },
    methods: {
        removeFromCart(item) {
            this.cart.items = this.cart.items.filter(i =&gt; i.product.id !== item.product.id)
        }
    },
    computed: {
        cartTotalLength() {
            return this.cart.items.reduce((acc, curVal) =&gt; {
                return acc += curVal.quantity
            }, 0)
        },
        cartTotalPrice() {
            return this.cart.items.reduce((acc, curVal) =&gt; {
                return acc += curVal.product.price * curVal.quantity
            }, 0)
        },
    }
}
&lt;/script&gt;
</code></pre>
<p>and the component CartItem.vue:</p>
<pre><code class="language-js">&lt;template&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;router-link :to=&quot;item.product.get_absolute_url&quot;&gt;{{ item.product.name }}&lt;/router-link&gt;&lt;/td&gt;
        &lt;td&gt;${{ item.product.price }}&lt;/td&gt;
        &lt;td&gt;
            {{ item.quantity }}
            &lt;a @click=&quot;decrementQuantity(item)&quot;&gt;-&lt;/a&gt;
            &lt;a @click=&quot;incrementQuantity(item)&quot;&gt;+&lt;/a&gt;
        &lt;/td&gt;
        &lt;td&gt;${{ getItemTotal(item).toFixed(2) }}&lt;/td&gt;
        &lt;td&gt;&lt;button class=&quot;delete&quot; @click=&quot;removeFromCart(item)&quot;&gt;&lt;/button&gt;&lt;/td&gt;
    &lt;/tr&gt;
&lt;/template&gt;

&lt;script&gt;
export default {
    name: 'CartItem',
    props: {
        initialItem: Object
    },
    data() {
        return {
            item: this.initialItem
        }
    },
    methods: {
        getItemTotal(item) {
            return item.quantity * item.product.price
        },
        decrementQuantity(item) {
            item.quantity -= 1
            if (item.quantity === 0) {
                this.$emit('removeFromCart', item)
            }
            this.updateCart()
        },
        incrementQuantity(item) {
            item.quantity += 1
            this.updateCart()
        },
        updateCart() {
            localStorage.setItem('cart', JSON.stringify(this.$store.state.cart))
        },
        removeFromCart(item) {
            this.$emit('removeFromCart', item)
            this.updateCart()
        },
    },
}
&lt;/script&gt;
</code></pre>
<p>Done!</p>
<h2 id="signup"><a class="header" href="#signup">Signup</a></h2>
<p>We only need to do the frontend part of this. The BE implementation is already done by importing djoser.
Create a sign-up page on the frontend. This one has forms with simple validation and a connection to the backend:</p>
<pre><code class="language-js">&lt;template&gt;
    &lt;div class=&quot;page-sign-up&quot;&gt;
        &lt;div class=&quot;columns&quot;&gt;
            &lt;div class=&quot;column is-4 is-offset-4&quot;&gt;
                &lt;h1 class=&quot;title&quot;&gt;Sign up&lt;/h1&gt;

                &lt;form @submit.prevent=&quot;submitForm&quot;&gt;
                    &lt;div class=&quot;field&quot;&gt;
                        &lt;label&gt;Username&lt;/label&gt;
                        &lt;div class=&quot;control&quot;&gt;
                            &lt;input type=&quot;text&quot; class=&quot;input&quot; v-model=&quot;username&quot;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&quot;field&quot;&gt;
                        &lt;label&gt;Password&lt;/label&gt;
                        &lt;div class=&quot;control&quot;&gt;
                            &lt;input type=&quot;password&quot; class=&quot;input&quot; v-model=&quot;password&quot;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&quot;field&quot;&gt;
                        &lt;label&gt;Repeat password&lt;/label&gt;
                        &lt;div class=&quot;control&quot;&gt;
                            &lt;input type=&quot;password&quot; class=&quot;input&quot; v-model=&quot;password2&quot;&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;div class=&quot;notification is-danger&quot; v-if=&quot;errors.length&quot;&gt;
                        &lt;p v-for=&quot;error in errors&quot; v-bind:key=&quot;error&quot;&gt;{{ error }}&lt;/p&gt;
                    &lt;/div&gt;

                    &lt;div class=&quot;field&quot;&gt;
                        &lt;div class=&quot;control&quot;&gt;
                            &lt;button class=&quot;button is-dark&quot;&gt;Sign up&lt;/button&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;

                    &lt;hr&gt;

                    Or &lt;router-link to=&quot;/log-in&quot;&gt;click here&lt;/router-link&gt; to log in!
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import { toast } from 'bulma-toast'
export default {
    name: 'SignUp',
    data() {
        return {
            username: '',
            password: '',
            password2: '',
            errors: []
        }
    },
    methods: {
        submitForm() {
            this.errors = []
            if (this.username === '') {
                this.errors.push('The username is missing')
            }
            if (this.password === '') {
                this.errors.push('The password is too short')
            }
            if (this.password !== this.password2) {
                this.errors.push('The passwords don\'t match')
            }
            if (!this.errors.length) {
                const formData = {
                    username: this.username,
                    password: this.password
                }
                axios
                    .post(&quot;/api/v1/users/&quot;, formData)
                    .then(response =&gt; {
                        toast({
                            message: 'Account created, please log in!',
                            type: 'is-success',
                            dismissible: true,
                            pauseOnHover: true,
                            duration: 2000,
                            position: 'bottom-right',
                        })
                        this.$router.push('/log-in')
                    })
                    .catch(error =&gt; {
                        if (error.response) {
                            for (const property in error.response.data) {
                                this.errors.push(`${property}: ${error.response.data[property]}`)
                            }
                            console.log(JSON.stringify(error.response.data))
                        } else if (error.message) {
                            this.errors.push('Something went wrong. Please try again')
                            
                            console.log(JSON.stringify(error))
                        }
                    })
            }
        }
    }
}
&lt;/script&gt;
</code></pre>
<p>the log in page will be almost identical.
For the state management on the fron end side (logged in , logged out) we have to add an option to initializeStore to set the isAuthenticated state in the store/index.js file that checks if a session token is present. Also, we need a function to set and remove the token. store/index.js:</p>
<pre><code class="language-js">  mutations: {
    initializeStore(state) {
	...
      if (localStorage.getItem('token')) {
        state.token = localStorage.getItem('token')
        state.isAuthenticated = true
      } else {
        state.token = ''
        state.isAuthenticated = false
      }
    },
    ...
    setToken(state, token) {
      state.token = token
      state.isAuthenticated = true
    },
    removeToken(state) {
      state.token = ''
      state.isAuthenticated = false
    }
</code></pre>
<p>to make the token available to our axios calls in our views, we add this bit to our App.vue file:</p>
<pre><code class="language-js">      const token = this.$store.state.token

      if (token) {
        axios.defaults.headers.common['Authorization'] = 'Token ' + token
      } else {
        axios.defaults.headers.common['Authorization'] = ''
      }
</code></pre>
<p>Done. BE implementation is done through djoser</p>
<h2 id="myaccount"><a class="header" href="#myaccount">Myaccount</a></h2>
<p>The myaccount page is a page where you can logout or see your order history. The page looks like this:</p>
<pre><code class="language-js">&lt;template&gt;
    &lt;div class=&quot;page-my-account&quot;&gt;
        &lt;div class=&quot;columns is-multiline&quot;&gt;
            &lt;div class=&quot;column is-12&quot;&gt;
                &lt;h1 class=&quot;title&quot;&gt;My account&lt;/h1&gt;
            &lt;/div&gt;

            &lt;div class=&quot;column is-12&quot;&gt;
                &lt;button @click=&quot;logout()&quot; class=&quot;button is-danger&quot;&gt;Log out&lt;/button&gt;
            &lt;/div&gt;

            &lt;hr&gt;

            &lt;div class=&quot;column is-12&quot;&gt;
                &lt;h2 class=&quot;subtitle&quot;&gt;My orders&lt;/h2&gt;

                &lt;OrderSummary
                    v-for=&quot;order in orders&quot;
                    v-bind:key=&quot;order.id&quot;
                    v-bind:order=&quot;order&quot; /&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
import axios from 'axios'
import OrderSummary from '@/components/OrderSummary.vue'
export default {
    name: 'MyAccount',
    components: {
        OrderSummary
    },
    data() {
        return {
            orders: []
        }
    },
    mounted() {
        document.title = 'My account | Djackets'
        this.getMyOrders()
    },
    methods: {
        logout() {
            axios.defaults.headers.common[&quot;Authorization&quot;] = &quot;&quot;
            localStorage.removeItem(&quot;token&quot;)
            localStorage.removeItem(&quot;username&quot;)
            localStorage.removeItem(&quot;userid&quot;)
            this.$store.commit('removeToken')
            this.$router.push('/')
        },
        async getMyOrders() {
            this.$store.commit('setIsLoading', true)
            await axios
                .get('/api/v1/orders/')
                .then(response =&gt; {
                    this.orders = response.data
                })
                .catch(error =&gt; {
                    console.log(error)
                })
            this.$store.commit('setIsLoading', false)
        }
    }
}
&lt;/script&gt;
</code></pre>
<p>the important part here is the router implementation:</p>
<pre><code class="language-js">...
import store from '../store'
...
const routes = [
...
  {
    path: '/my-account',
    name: 'MyAccount',
    component: MyAccount,
    meta: {
      requireLogin: true
    }
  },
]

const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes
})

router.beforeEach((to, from, next) =&gt; {
  if (to.matched.some(record =&gt; record.meta.requireLogin) &amp;&amp; !store.state.isAuthenticated) {// if the page that is about to be accessed has requireLogin true and isAuthenticated is false ...
    next({ name: 'LogIn', query: { to: to.path } });//... you will be forwarded to the login page ...
  } else {
    next()//... if not you will be forwarded to the page that had been requested
  }
})
</code></pre>
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTc1NDc1ODY0OF19
-->
                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    
                    <a rel="prev" href="../../../webdevelopment/backend/django/model.html" class="mobile-nav-chapters previous"
                        title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                    

                    
                    <a rel="next" href="../../../webdevelopment/backend/django/fixtures.html" class="mobile-nav-chapters next"
                        title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                    

                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            
            <a rel="prev" href="../../../webdevelopment/backend/django/model.html" class="nav-chapters previous" title="Previous chapter"
                aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>
            

            
            <a rel="next" href="../../../webdevelopment/backend/django/fixtures.html" class="nav-chapters next" title="Next chapter"
                aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
            
        </nav>

    </div>

    

    

    

    
    <script type="text/javascript">
        window.playground_copyable = true;
    </script>
    

    

    
    <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
    

    <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

    <!-- Custom JS scripts -->
    

    

</body>

</html>